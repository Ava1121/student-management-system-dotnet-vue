南华大学
 计算机学院/软件学院
 课程实验报告

 课程名称：
 系统名称：学生管理系统
 任课教师：


 学号    姓名    班级
       


 2024年秋季学期

 目  录

 一、 系统目标    1
 二、 系统业务需求    1
 三、 系统总体设计    2
 3.1 系统功能结构    2
 3.2 数据库设计    2
 四、 系统详细设计    3
 4.1 系统开发环境    3
 4.2 数据库设计    3
 五、 系统实现    5
 5.1 系统文件架构图    5
 5.2 数据库结构图    5
 5.3 登录模块实现    5
 5.4 系统主窗体实现    5
 5.5 学生管理模块实现    5
 六、 个人心得与总结    5

 一、系统目标
 本实验基于实验 1-3 的技术积累，实现一个前后端分离的学生管理系统。通过本次实验，学生应掌握前后端分离架构的核心思想与实现方式，熟练使用 .NET Web API 构建 RESTful 接口，掌握 EF Framework Code First 开发模式，理解并应用 Autofac IOC 容器实现依赖注入，学会使用前端框架与后端 API 进行交互。

 二、系统业务需求
 说明：该部分主要介绍系统的功能性需求，先介绍总体功能，再分别介绍各个子功能，给出相应的用例图。

 学生管理系统是一个典型的教育管理系统，主要用于管理学生信息、课程信息和成绩信息。系统分为管理员和学生两种角色，具有不同的功能权限。

 1) 基础信息管理，基础信息是系统能够正常运转的前提条件，基于信息化的学生管理系统可以有效节约人力财力，诸如实现无纸化办公，实现信息收集与汇总自动化等；
 2) 学生信息管理，包括学生的基本信息、课程信息和成绩信息的管理；
 3) 课程信息管理，包括课程的基本信息、教师信息和学生选课信息的管理；
 4) 成绩信息管理，包括学生成绩的录入、查询和统计分析。

 (1) 学生信息管理
 通过前面的介绍内容可知，本系统中，基础信息的有效采集是整个系统运转的前提。学生的个人信息又可分为基本身份信息、课程信息、成绩信息等。不同的信息来源势必会有不同的信息内容，基本身份信息收集的内容是学生的姓名、性别、年龄、邮箱等信息；课程信息采集的内容应该有学生选修的课程、教师信息等；成绩信息采集的信息主要有学生的考试成绩、平时成绩等。

 (2) 课程信息管理
 课程信息管理模块主要负责课程的基本信息管理，包括课程的添加、修改、删除和查询。管理员可以通过该模块管理所有课程信息，学生可以查看自己选修的课程信息。

 (3) 成绩信息管理
 成绩信息管理模块主要负责学生成绩的录入、修改、删除和查询。管理员可以通过该模块管理所有学生的成绩信息，学生可以查看自己的成绩信息。

 三、系统总体设计
 3.1 系统功能结构
 该部分主要给出系统功能模块图，并对各个功能进行介绍。

 学生管理系统采用前后端分离架构，分为前端和后端两个部分。前端负责用户界面和交互逻辑，后端负责业务逻辑和数据处理。系统功能结构如下：

 1. **前端功能模块**：
    - 登录模块：实现用户登录功能，包括用户名和密码验证
    - 学生模块：包括学生个人信息、课程信息和成绩信息的查看
    - 管理员模块：包括学生管理、课程管理和成绩管理

 2. **后端功能模块**：
    - 认证模块：实现 JWT Token 认证和授权
    - 学生模块：实现学生信息的 CRUD 操作
    - 课程模块：实现课程信息的 CRUD 操作
    - 成绩模块：实现成绩信息的 CRUD 操作
    - 数据访问模块：实现数据的持久化存储

 3.2 数据库设计
    该部分主要描述系统实体和实体关系

 (1) 系统实体描述
 通过需求分析以及概要设计功能模块分析阶段可以得出本系统具体的数据实体（主键通过下划线标识）。

 - 学生（_Id_，Name，Age，Email）
 - 课程（_Id_，Title，Credits）
 - 成绩（_Id_，StudentId，CourseId，Grade）
 - 用户（_Id_，Username，Password，Role）

 (2) 实体关系描述
 - 学生-成绩：一个学生可以有多个成绩，一个成绩只属于一个学生
 - 课程-成绩：一个课程可以有多个成绩，一个成绩只属于一个课程

 四、系统详细设计
 4.1 系统开发环境
 本系统采用了稳定的开发环境，在一定程度上保证学生管理系统开发工作的平稳进行，系统开发环境如下表4.1所示。

 表4.1 系统开发环境表
 操作系统    Windows10
 开发工具    Visual Studio 2022, VS Code
 数据库    SQL Server 2019
 后端框架    .NET 6 Web API
 前端框架    Vue.js 3
 依赖注入    Autofac
 数据库访问    EF Core Code First
 HTTP客户端    Axios
 UI组件库    Element Plus

 4.2 数据库设计

 (1) 系统ER图

 系统主要包含以下实体：
 - 学生：包含学生的基本信息
 - 课程：包含课程的基本信息
 - 成绩：包含学生的成绩信息
 - 用户：包含系统用户的登录信息

 (2) 数据表的设计
 通过上一阶段的梳理，学生管理系统一共包含4个数据表：学生表、课程表、成绩表、用户表。

 学生表，表名Students。
 表4.2-1 学生表
 序号    字段名    中文描述    数据类型    允许为空    约束条件
 1    Id    学生ID    int    否    主键、自动递增
 2    Name    姓名    varchar    否    
 3    Age    年龄    int    否    
 4    Email    邮箱    varchar    否    

 课程表，表名Courses。
 表4.2-2 课程表
 序号    字段名    中文描述    数据类型    允许为空    约束条件
 1    Id    课程ID    int    否    主键、自动递增
 2    Title    课程名称    varchar    否    
 3    Credits    学分    int    否    

 成绩表，表名Enrollments。
 表4.2-3 成绩表
 序号    字段名    中文描述    数据类型    允许为空    约束条件
 1    Id    成绩ID    int    否    主键、自动递增
 2    StudentId    学生ID    int    否    外键，关联Students表
 3    CourseId    课程ID    int    否    外键，关联Courses表
 4    Grade    成绩    int    否    

 用户表，表名Users。
 表4.2-4 用户表
 序号    字段名    中文描述    数据类型    允许为空    约束条件
 1    Id    用户ID    int    否    主键、自动递增
 2    Username    用户名    varchar    否    
 3    Password    密码    varchar    否    
 4    Role    角色    varchar    否    

 (3) 数据表的逻辑关系图
 该部分给出数据表的逻辑关系图。学生表和课程表通过成绩表建立多对多的关系，用户表与学生表是一对一的关系。

 五、系统实现
 5.1 系统文件架构图

 后端 Web API 项目结构：
 ```
 Backend/
 ├── Controllers/          # API控制器
 │   ├── AuthController.cs     # 认证相关接口
 │   ├── CourseController.cs   # 课程管理接口
 │   ├── EnrollmentController.cs # 成绩管理接口
 │   └── StudentController.cs  # 学生管理接口
 ├── Models/               # 数据模型
 │   ├── Course.cs             # 课程实体
 │   ├── Enrollment.cs         # 成绩实体
 │   ├── Student.cs            # 学生实体
 │   └── User.cs               # 用户实体
 ├── Data/                 # 数据访问层
 │   └── SchoolContext.cs      # DbContext配置
 ├── Program.cs            # 应用入口和中间件配置
 └── appsettings.json      # 应用配置
 ```

 前端项目结构：
 ```
 frontend/
 ├── src/
 │   ├── components/       # 组件
 │   ├── views/            # 页面
 │   │   ├── Admin/            # 管理员页面
 │   │   │   ├── CourseManagement.vue    # 课程管理
 │   │   │   ├── EnrollmentManagement.vue # 成绩管理
 │   │   │   └── StudentManagement.vue   # 学生管理
 │   │   ├── Student/          # 学生页面
 │   │   │   ├── MyCourses.vue    # 我的课程
 │   │   │   ├── MyGrades.vue     # 我的成绩
 │   │   │   └── StudentProfile.vue  # 个人信息
 │   │   ├── Login.vue         # 登录页面
 │   │   └── Layout.vue        # 布局页面
 │   ├── router/           # 路由配置
 │   ├── utils/            # 工具函数
 │   │   └── request.js        # Axios封装
 │   ├── App.vue           # 根组件
 │   └── main.js           # 应用入口
 └── package.json          # 项目依赖
 ```

 5.2 数据库结构图

 数据库采用SQL Server 2019，包含4个核心表：
 - Students：存储学生基本信息
 - Courses：存储课程基本信息
 - Enrollments：存储学生成绩信息
 - Users：存储系统用户信息

 各表之间的关系如下：
 - Students 与 Enrollments：一对多关系，一个学生可以有多个成绩
 - Courses 与 Enrollments：一对多关系，一个课程可以有多个学生选修
 - Users 与 Students：一对一关系，每个用户对应一个学生

 5.3 登录模块实现
 登录模块是系统的入口，负责用户身份验证和授权。前端使用Vue.js实现登录页面，后端使用JWT Token实现认证。

 核心代码实现：

 前端登录页面：
 ```vue
 <template>
   <div class="login-container">
     <el-card class="login-card" shadow="hover">
       <template #header>
         <div class="login-title">学生管理系统登录</div>
       </template>
       
       <el-form :model="loginForm" :rules="rules" ref="loginFormRef" label-width="80px">
         <el-form-item label="用户名" prop="username">
           <el-input v-model="loginForm.username" placeholder="请输入用户名"></el-input>
         </el-form-item>
         <el-form-item label="密码" prop="password">
           <el-input type="password" v-model="loginForm.password" placeholder="请输入密码" show-password></el-input>
         </el-form-item>
         <el-form-item>
           <el-button type="primary" @click="handleLogin" :loading="loading" block>登录</el-button>
         </el-form-item>
       </el-form>
     </el-card>
   </div>
 </template>

 <script setup>
 import { ref, reactive } from 'vue'
 import { useRouter } from 'vue-router'
 import request from '@/utils/request'

 const router = useRouter()
 const loginFormRef = ref()
 const loading = ref(false)

 const loginForm = reactive({
   username: '',
   password: ''
 })

 const rules = {
   username: [
     { required: true, message: '请输入用户名', trigger: 'blur' }
   ],
   password: [
     { required: true, message: '请输入密码', trigger: 'blur' }
   ]
 }

 const handleLogin = async () => {
   if (!loginFormRef.value) return
   
   try {
     await loginFormRef.value.validate()
     loading.value = true
     
     const res = await request.post('/auth/login', loginForm)
     if (res.token) {
       localStorage.setItem('token', res.token)
       localStorage.setItem('role', res.role)
       
       if (res.role === 'Admin') {
         router.push('/admin/students')
       } else {
         router.push('/student/profile')
       }
     }
   } catch (error) {
     console.error('登录失败:', error)
   } finally {
     loading.value = false
   }
 }
 </script>
 ```

 后端认证控制器：
 ```csharp
 [ApiController]
 [Route("api/[controller]")]
 public class AuthController : ControllerBase
 {
     [HttpPost("login")]
     public IActionResult Login([FromBody] LoginRequest request)
     {
         // 验证用户名和密码
         // 生成 JWT Token
         // 返回 Token 和角色
     }
 }
 ```

 5.4 系统主窗体实现
 系统主窗体采用Vue Router实现页面导航，包含侧边栏和主内容区。侧边栏根据用户角色显示不同的菜单选项，主内容区显示当前选中的页面内容。

 核心代码实现：

 ```vue
 <template>
   <div class="layout-container">
     <el-container>
       <el-aside width="200px" class="aside">
         <el-menu :default-active="activeMenu" class="el-menu-vertical-demo" @select="handleMenuSelect">
           <!-- 管理员菜单 -->
           <template v-if="role === 'Admin'">
             <el-sub-menu index="admin">
               <template #title>
                 <span>管理员管理</span>
               </template>
               <el-menu-item index="/admin/students">学生管理</el-menu-item>
               <el-menu-item index="/admin/courses">课程管理</el-menu-item>
               <el-menu-item index="/admin/enrollments">成绩管理</el-menu-item>
             </el-sub-menu>
           </template>
           
           <!-- 学生菜单 -->
           <template v-else>
             <el-sub-menu index="student">
               <template #title>
                 <span>学生管理</span>
               </template>
               <el-menu-item index="/student/profile">个人信息</el-menu-item>
               <el-menu-item index="/student/courses">我的课程</el-menu-item>
               <el-menu-item index="/student/grades">我的成绩</el-menu-item>
             </el-sub-menu>
           </template>
         </el-menu>
       </el-aside>
       
       <el-container>
         <el-main>
           <router-view></router-view>
         </el-main>
       </el-container>
     </el-container>
   </div>
 </template>

 <script setup>
 import { ref, computed } from 'vue'
 import { useRoute, useRouter } from 'vue-router'

 const route = useRoute()
 const router = useRouter()
 const role = ref(localStorage.getItem('role'))

 const activeMenu = computed(() => {
   return route.path
 })

 const handleMenuSelect = (index) => {
   router.push(index)
 }
 </script>
 ```

 5.5 学生管理模块实现
 学生管理模块是系统的核心功能之一，负责学生信息的添加、修改、删除和查询。管理员可以通过该模块管理所有学生信息，学生可以查看自己的个人信息。

 核心代码实现：

 前端学生管理页面：
 ```vue
 <template>
   <div class="student-list">
     <el-card shadow="hover">
       <template #header>
         <div class="card-header">
           <span>学生管理</span>
           <el-button type="primary" @click="handleAdd">新增学生</el-button>
         </div>
       </template>
       
       <el-table :data="students" stripe>
         <el-table-column prop="id" label="学生ID" width="100"></el-table-column>
         <el-table-column prop="name" label="姓名" width="120"></el-table-column>
         <el-table-column prop="age" label="年龄" width="80"></el-table-column>
         <el-table-column prop="email" label="邮箱"></el-table-column>
         <el-table-column label="操作" width="200">
           <template #default="scope">
             <el-button type="primary" size="small" @click="handleEdit(scope.row)">编辑</el-button>
             <el-button type="danger" size="small" @click="handleDelete(scope.row.id)">删除</el-button>
           </template>
         </el-table-column>
       </el-table>
     </el-card>
     
     <!-- 新增/编辑对话框 -->
     <el-dialog v-model="dialogVisible" :title="dialogTitle" width="500px">
       <el-form :model="form" :rules="rules" ref="formRef" label-width="80px">
         <el-form-item label="学生ID" prop="id">
           <el-input v-model="form.id" :disabled="isEdit" placeholder="请输入学生ID"></el-input>
         </el-form-item>
         <el-form-item label="姓名" prop="name">
           <el-input v-model="form.name" placeholder="请输入姓名"></el-input>
         </el-form-item>
         <el-form-item label="年龄" prop="age">
           <el-input v-model.number="form.age" placeholder="请输入年龄"></el-input>
         </el-form-item>
         <el-form-item label="邮箱" prop="email">
           <el-input v-model="form.email" placeholder="请输入邮箱"></el-input>
         </el-form-item>
       </el-form>
       <template #footer>
         <span class="dialog-footer">
           <el-button @click="dialogVisible = false">取消</el-button>
           <el-button type="primary" @click="handleSubmit">确定</el-button>
         </span>
       </template>
     </el-dialog>
   </div>
 </template>

 <script setup>
 import { ref, reactive, onMounted } from 'vue'
 import request from '@/utils/request'

 const formRef = ref()
 const dialogVisible = ref(false)
 const isEdit = ref(false)
 const dialogTitle = ref('新增学生')
 const students = ref([])

 const form = reactive({
   id: '',
   name: '',
   age: '',
   email: ''
 })

 const rules = {
   id: [
     { required: true, message: '请输入学生ID', trigger: 'blur' }
   ],
   name: [
     { required: true, message: '请输入姓名', trigger: 'blur' }
   ],
   age: [
     { required: true, message: '请输入年龄', trigger: 'blur' },
     { type: 'number', min: 16, max: 30, message: '年龄必须在16到30岁之间', trigger: 'blur' }
   ],
   email: [
     { required: true, message: '请输入邮箱', trigger: 'blur' },
     { type: 'email', message: '邮箱格式不正确', trigger: 'blur' }
   ]
 }

 // 获取学生列表
 const getStudents = async () => {
   try {
     const res = await request.get('/students')
     students.value = res
   } catch (error) {
     console.error('获取学生列表失败:', error)
   }
 }

 // 新增学生
 const handleAdd = () => {
   isEdit.value = false
   dialogTitle.value = '新增学生'
   resetForm()
   dialogVisible.value = true
 }

 // 编辑学生
 const handleEdit = (row) => {
   isEdit.value = true
   dialogTitle.value = '编辑学生'
   Object.assign(form, row)
   dialogVisible.value = true
 }

 // 提交表单
 const handleSubmit = async () => {
   if (!formRef.value) return
   
   try {
     await formRef.value.validate()
     
     if (isEdit.value) {
       await request.put(`/students/${form.id}`, form)
     } else {
       await request.post('/students', form)
     }
     dialogVisible.value = false
     getStudents()
   } catch (